# Configurazione per GitHub Pages - Flutter Web App
# Abilita compressione gzip
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/wasm
</IfModule>

# Configurazione MIME types per Flutter Web
<IfModule mod_mime.c>
    # JavaScript files
    AddType application/javascript .js
    AddType application/javascript .mjs
    
    # WebAssembly files
    AddType application/wasm .wasm
    
    # JSON files
    AddType application/json .json
    
    # Font files
    AddType font/woff2 .woff2
    AddType font/woff .woff
    AddType font/ttf .ttf
    AddType font/otf .otf
    
    # Image files
    AddType image/png .png
    AddType image/svg+xml .svg
    AddType image/webp .webp
</IfModule>

# Single Page Application (SPA) routing
# Reindirizza tutte le richieste non-file all'index.html
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Handle Angular and other SPA routing
    # If the requested resource doesn't exist as a file or directory
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # Redirect everything to index.html
    RewriteRule . /sistemaAntiNervoso/index.html [L]
</IfModule>

# Cache headers per performance
<IfModule mod_expires.c>
    ExpiresActive on
    
    # Cache JavaScript e CSS per 1 anno
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType text/css "access plus 1 year"
    
    # Cache WebAssembly per 1 anno
    ExpiresByType application/wasm "access plus 1 year"
    
    # Cache immagini per 1 mese
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    
    # Cache fonts per 1 anno
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/ttf "access plus 1 year"
    
    # Non cachare l'HTML principale
    ExpiresByType text/html "access plus 0 seconds"
</IfModule>

# Security headers
<IfModule mod_headers.c>
    # Abilita CORS se necessario
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
    
    # Security headers
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>

# Fallback per GitHub Pages che non supporta .htaccess
# Questo file serve come documentazione per altri hosting